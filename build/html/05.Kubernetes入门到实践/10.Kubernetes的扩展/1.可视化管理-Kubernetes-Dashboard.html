<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>可视化管理-Kubernetes Dashboard &mdash; 运维开发修炼之路</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="资源监控-Prometheus与Grafana" href="2.%E8%B5%84%E6%BA%90%E7%9B%91%E6%8E%A7-Prometheus%E4%B8%8EGrafana.html" />
    <link rel="prev" title="10.Kubernetes的扩展" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> 小健_Docker_K8s_Blog
            <img src="../../_static/docker-k8s.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../01.Docker%E6%8A%80%E6%9C%AF%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%9E%E6%88%983%E7%89%88/index.html">01.Docker技术入门与实战3版</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../02.Kubernetes%E5%AE%9E%E6%88%98%E6%8C%87%E5%8D%97/index.html">02.Kubernetes实战指南</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../03.Docker%E7%BB%8F%E5%85%B8%E5%AE%9E%E4%BE%8B/index.html">03.Docker经典实例</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../04.Prometheus%E7%9B%91%E6%8E%A7%E8%BF%90%E7%BB%B4%E5%AE%9E%E6%88%98/index.html">04.Prometheus监控运维实战</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">05.Kubernetes入门到实践</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../1.%E5%AE%B9%E5%99%A8%E7%9A%84%E5%8F%91%E5%B1%95%E5%8F%B2/index.html">1.容器的发展史</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2.Kubernetes%E7%9A%84%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5/index.html">2.Kubernetes的核心概念</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3.Kubernetes%E7%9A%84%E5%AE%89%E8%A3%85%E5%92%8C%E9%83%A8%E7%BD%B2/index.html">3.Kubernetes的安装和部署</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.Pod/index.html">4.Pod的基本操作</a></li>
<li class="toctree-l2"><a class="reference internal" href="../5.%E6%8E%A7%E5%88%B6%E5%99%A8/index.html">5.控制器</a></li>
<li class="toctree-l2"><a class="reference internal" href="../6.Service%E5%92%8CIngress/index.html">6.Service和Ingress</a></li>
<li class="toctree-l2"><a class="reference internal" href="../7.%E5%AD%98%E5%82%A8%E4%B8%8E%E9%85%8D%E7%BD%AE/index.html">7.存储与配置</a></li>
<li class="toctree-l2"><a class="reference internal" href="../8.Kubernetes%E8%B5%84%E6%BA%90%E7%9A%84%E7%AE%A1%E7%90%86%E5%8F%8A%E8%B0%83%E5%BA%A6/index.html">8.Kubernetes资源的管理及调度</a></li>
<li class="toctree-l2"><a class="reference internal" href="../9.API-Server/index.html">9.API-Server</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">10.Kubernetes的扩展</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">可视化管理-Kubernetes Dashboard</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">1. 安装Kubernetes Dashboard</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id6">2.使用Kubernetes Dashboard</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dashboard-kubeconfig">3.Dashboard组件安装-kubeconfig</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="2.%E8%B5%84%E6%BA%90%E7%9B%91%E6%8E%A7-Prometheus%E4%B8%8EGrafana.html">资源监控-Prometheus与Grafana</a></li>
<li class="toctree-l3"><a class="reference internal" href="3.%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86-EFK.html">日志管理-EFK</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">小健_Docker_K8s_Blog</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html">05.Kubernetes入门到实践</a> &raquo;</li>
          <li><a href="index.html">10.Kubernetes的扩展</a> &raquo;</li>
      <li>可视化管理-Kubernetes Dashboard</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/05.Kubernetes入门到实践/10.Kubernetes的扩展/1.可视化管理-Kubernetes-Dashboard.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="contents topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#kubernetes-dashboard" id="id9">可视化管理-Kubernetes Dashboard</a></p>
<ul>
<li><p><a class="reference internal" href="#id1" id="id10">1. 安装Kubernetes Dashboard</a></p>
<ul>
<li><p><a class="reference internal" href="#id2" id="id11">1.1 创建证书</a></p></li>
<li><p><a class="reference internal" href="#id3" id="id12">1.2 下载并修改配置文件</a></p></li>
<li><p><a class="reference internal" href="#dashboard" id="id13">1.3 运行dashboard</a></p></li>
<li><p><a class="reference internal" href="#id4" id="id14">1.4 更新配置信息</a></p></li>
<li><p><a class="reference internal" href="#token" id="id15">1.5 获取token信息</a></p></li>
<li><p><a class="reference internal" href="#id5" id="id16">1.6 登录访问dashboard</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#id6" id="id17">2.使用Kubernetes Dashboard</a></p></li>
<li><p><a class="reference internal" href="#dashboard-kubeconfig" id="id18">3.Dashboard组件安装-kubeconfig</a></p>
<ul>
<li><p><a class="reference internal" href="#id7" id="id19">3.1 设置变量</a></p></li>
<li><p><a class="reference internal" href="#id8" id="id20">3.2 初始化集群信息</a></p></li>
<li><p><a class="reference internal" href="#dashboard-admintoken" id="id21">3.3 获取dashboard-admin的token</a></p></li>
<li><p><a class="reference internal" href="#context" id="id22">3.4 设置context列表</a></p></li>
<li><p><a class="reference internal" href="#contextdashboard-admincontext" id="id23">3.5 使用的context为前面定义的名为dashboard-admin的context：</a></p></li>
<li><p><a class="reference internal" href="#kubeconfig-kubeconfig" id="id24">3.6 传输kubeconfig，然后使用kubeconfig登录</a></p></li>
<li><p><a class="reference internal" href="#admin" id="id25">3.7 切换到admin用户</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<section id="kubernetes-dashboard">
<h1><a class="toc-backref" href="#id9">可视化管理-Kubernetes Dashboard</a><a class="headerlink" href="#kubernetes-dashboard" title="Permalink to this headline">¶</a></h1>
<p>Kubernetes
Dashboard是一个非常受欢迎的项目，为Kubernetes用户管理Kubernetes集群提供了非常便捷的可视化管理工具。</p>
<p>Kubernetes
Dashboard可以实现Pod、控制器、Service、存储卷等资源的创建与维护，并可以对它们进行持续的监控。</p>
<p>Kubernetes Dashboard 是 Kubernetes 的官方 Web UI。使用 Kubernetes
Dashboard，您可以：</p>
<ul class="simple">
<li><p>向 Kubernetes 集群部署容器化应用</p></li>
<li><p>诊断容器化应用的问题</p></li>
<li><p>管理集群的资源</p></li>
<li><p>查看集群上所运行的应用程序</p></li>
<li><p>创建、修改Kubernetes 上的资源（例如 Deployment、Job、DaemonSet等）</p></li>
<li><p>展示集群上发生的错误</p></li>
</ul>
<p>例如：您可以伸缩一个 Deployment、执行滚动更新、重启一个 Pod
或部署一个新的应用程序</p>
<section id="id1">
<h2><a class="toc-backref" href="#id10">1. 安装Kubernetes Dashboard</a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<section id="id2">
<h3><a class="toc-backref" href="#id11">1.1 创建证书</a><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>因为自动生成的证书很多浏览器无法使用，所以自己创建证书</p>
<ul class="simple">
<li><p>新建证书存放目录</p></li>
</ul>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ mkdir -p /etc/kubernetes/dashboard-certs
$ <span class="nb">cd</span> /etc/kubernetes/dashboard-certs/
</pre></div>
</div>
<ul class="simple">
<li><p>创建命名空间</p></li>
</ul>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ kubectl create namespace kubernetes-dashboard
</pre></div>
</div>
<ul class="simple">
<li><p>创建key文件</p></li>
</ul>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ openssl genrsa -out dashboard.key <span class="m">2048</span>
</pre></div>
</div>
<ul class="simple">
<li><p>证书请求</p></li>
</ul>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ openssl req -new -out dashboard.csr -key dashboard.key -subj <span class="s1">&#39;/CN=kubernetes-dashboard-certs&#39;</span>
</pre></div>
</div>
<ul class="simple">
<li><p>自签证书</p></li>
</ul>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ openssl x509 -req -days <span class="m">36000</span> -in dashboard.csr -signkey dashboard.key -out dashboard.crt
</pre></div>
</div>
<ul class="simple">
<li><p>创建kubernetes-dashboard-certs对象</p></li>
</ul>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ kubectl create secret generic kubernetes-dashboard-certs --from-file<span class="o">=</span>dashboard.key --from-file<span class="o">=</span>dashboard.crt -n kubernetes-dashboard
</pre></div>
</div>
</section>
<section id="id3">
<h3><a class="toc-backref" href="#id12">1.2 下载并修改配置文件</a><a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p>下载配置文件</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ mkdir kubernetes-dashboard
$ <span class="nb">cd</span> kubernetes-dashboard
$ wget https://raw.githubusercontent.com/kubernetes/dashboard/v2.1.0/aio/deploy/recommended.yaml
</pre></div>
</div>
<ul class="simple">
<li><p>修改配置文件，增加直接访问端口</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">vim</span> <span class="pre">recommended.yaml</span></code></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">......</span>
<span class="nn">---</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Service</span>
<span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">labels</span><span class="p">:</span>
    <span class="nt">k8s-app</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">kubernetes-dashboard</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">kubernetes-dashboard</span>
  <span class="nt">namespace</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">kubernetes-dashboard</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">NodePort</span>
  <span class="nt">ports</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">port</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">443</span>
      <span class="nt">targetPort</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">8443</span>
      <span class="nt">nodePort</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">30010</span>
  <span class="nt">selector</span><span class="p">:</span>
    <span class="nt">k8s-app</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">kubernetes-dashboard</span>

<span class="nn">---</span>
<span class="l l-Scalar l-Scalar-Plain">.....</span>
</pre></div>
</div>
<ul class="simple">
<li><p>修改配置文件，注释原kubernetes-dashboard-certs对象声明</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---</span>

<span class="c1">#apiVersion: v1</span>
<span class="c1">#kind: Secret</span>
<span class="c1">#metadata:</span>
<span class="c1">#  labels:</span>
<span class="c1">#    k8s-app: kubernetes-dashboard</span>
<span class="c1">#  name: kubernetes-dashboard-certs</span>
<span class="c1">#  namespace: kubernetes-dashboard</span>
<span class="c1">#type: Opaque</span>

<span class="c1">#---</span>
</pre></div>
</div>
</section>
<section id="dashboard">
<h3><a class="toc-backref" href="#id13">1.3 运行dashboard</a><a class="headerlink" href="#dashboard" title="Permalink to this headline">¶</a></h3>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ kubectl apply -f recommended.yaml
</pre></div>
</div>
</section>
<section id="id4">
<h3><a class="toc-backref" href="#id14">1.4 更新配置信息</a><a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>创建Dashboard管理员账号dashboard-admin.yaml，并apply</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">dashboard-admin.yaml</span></code></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ServiceAccount</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">labels</span><span class="p">:</span>
    <span class="nt">k8s-app</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">kubernetes-dashboard</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">dashboard-admin</span>
  <span class="nt">namespace</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">kubernetes-dashboard</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">dashboard-admin-bind-cluster-role.yaml</span></code></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">rbac.authorization.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ClusterRoleBinding</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">dashboard-admin-bind-cluster-role</span>
  <span class="nt">labels</span><span class="p">:</span>
    <span class="nt">k8s-app</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">kubernetes-dashboard</span>
<span class="nt">roleRef</span><span class="p">:</span>
  <span class="nt">apiGroup</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">rbac.authorization.k8s.io</span>
  <span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ClusterRole</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cluster-admin</span>
<span class="nt">subjects</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ServiceAccount</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">dashboard-admin</span>
  <span class="nt">namespace</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">kubernetes-dashboard</span>
</pre></div>
</div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ kubectl apply -f dashboard-admin.yaml
$ kubectl apply -f dashboard-admin-bind-cluster-role.yaml
</pre></div>
</div>
</section>
<section id="token">
<h3><a class="toc-backref" href="#id15">1.5 获取token信息</a><a class="headerlink" href="#token" title="Permalink to this headline">¶</a></h3>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ kubectl -n kubernetes-dashboard describe secret <span class="k">$(</span>kubectl -n kubernetes-dashboard get secret <span class="p">|</span> grep dashboard-admin <span class="p">|</span> awk <span class="s1">&#39;{print $1}&#39;</span><span class="k">)</span>
Name:         dashboard-admin-token-5chxg
Namespace:    kubernetes-dashboard
Labels:       &lt;none&gt;
Annotations:  kubernetes.io/service-account.name: dashboard-admin
              kubernetes.io/service-account.uid: 25df4002-d67e-4ed5-a331-3f46ea0c6742

Type:  kubernetes.io/service-account-token

<span class="nv">Data</span>
<span class="o">====</span>
ca.crt:     <span class="m">1066</span> bytes
namespace:  <span class="m">20</span> bytes
token:      eyJhbGciOiJSUzI1NiIsImtpZCI6Im9aREhrU2JwdEZZc3B5Tk9fOU5CNmRWQkE4MWpaOGdKR3drbDJEVUo1dzAifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJrdWJlcm5ldGVzLWRhc2hib2FyZCIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VjcmV0Lm5hbWUiOiJkYXNoYm9hcmQtYWRtaW4tdG9rZW4tNWNoeGciLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC5uYW1lIjoiZGFzaGJvYXJkLWFkbWluIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQudWlkIjoiMjVkZjQwMDItZDY3ZS00ZWQ1LWEzMzEtM2Y0NmVhMGM2NzQyIiwic3ViIjoic3lzdGVtOnNlcnZpY2VhY2NvdW50Omt1YmVybmV0ZXMtZGFzaGJvYXJkOmRhc2hib2FyZC1hZG1pbiJ9.YI6-dhDg2lIMfYbv4s_FjFAHYhj4ZcWZ5Eu13Nw1g1hcLDPVuI69hDAfoYRGfBoDDidCClLsSCdPIsMAuOj16jnlugzy9n6gEkpTNY1Du3zVGY8jdHmdbFWZK9bd2NHxO0gC-cLcHZ9MctLgrnMylysGsrtvFPB8wepzr2rMKzgfuBvfv00gp8-u_NeIPUDEr2jVteQkK2RHMOU_bBS49FKAu7LvHlxy_bYqqlu3gNX_znfT1AY7cVF8GiwnCSvqV6OJQaLY_ohgNrvoaT19muw6lkaLMJrWFexNszRpdmw9lk3edigPj4xo8Da6DQYpNXICLKJXWMTS5JHli2SsBw
</pre></div>
</div>
</section>
<section id="id5">
<h3><a class="toc-backref" href="#id16">1.6 登录访问dashboard</a><a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<p>登录访问: <code class="docutils literal notranslate"><span class="pre">https://192.168.1.58:30010/</span></code></p>
<img alt="../../_images/image-20220421132345927.png" src="../../_images/image-20220421132345927.png" />
<img alt="../../_images/image-20220421132622419.png" src="../../_images/image-20220421132622419.png" />
</section>
</section>
<section id="id6">
<h2><a class="toc-backref" href="#id17">2.使用Kubernetes Dashboard</a><a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h2>
<p>图形界面点点点即可实现部署、更新回滚。</p>
<p>相对于直接使用命令行来说，使用Kubernetes
Dashboard对集群资源进行可视化管理更清晰、直观、方便。</p>
</section>
<section id="dashboard-kubeconfig">
<h2><a class="toc-backref" href="#id18">3.Dashboard组件安装-kubeconfig</a><a class="headerlink" href="#dashboard-kubeconfig" title="Permalink to this headline">¶</a></h2>
<section id="id7">
<h3><a class="toc-backref" href="#id19">3.1 设置变量</a><a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>获取dashboard-admin-token的名称</p></li>
</ul>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ kubectl get secrets --all-namespaces <span class="p">|</span> grep dashboard-admin-token
</pre></div>
</div>
<ul class="simple">
<li><p>获取token</p></li>
</ul>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ <span class="nv">DASH_TOCKEN</span><span class="o">=</span><span class="k">$(</span>kubectl -n kubernetes-dashboard get secret dashboard-admin-token-9k522 -o <span class="nv">jsonpath</span><span class="o">={</span>.data.token<span class="o">}</span><span class="p">|</span> base64 -d<span class="k">)</span>
</pre></div>
</div>
</section>
<section id="id8">
<h3><a class="toc-backref" href="#id20">3.2 初始化集群信息</a><a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<p>提供API Server的URL，以及验证API Server证书所用到的CA证书等</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ kubectl config set-cluster kubernetes --server<span class="o">=</span><span class="m">192</span>.168.1.56:6443 --kubeconfig<span class="o">=</span>/root/dashbord-admin.conf
</pre></div>
</div>
</section>
<section id="dashboard-admintoken">
<h3><a class="toc-backref" href="#id21">3.3 获取dashboard-admin的token</a><a class="headerlink" href="#dashboard-admintoken" title="Permalink to this headline">¶</a></h3>
<p>并将其作为认证信息。</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ kubectl config set-credentials dashboard-admin --token<span class="o">=</span><span class="nv">$DASH_TOCKEN</span> --kubeconfig<span class="o">=</span>/root/dashbord-admin.conf
</pre></div>
</div>
</section>
<section id="context">
<h3><a class="toc-backref" href="#id22">3.4 设置context列表</a><a class="headerlink" href="#context" title="Permalink to this headline">¶</a></h3>
<p>定义一个名为dashboard-admin的context：</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ kubectl config set-context dashboard-admin@kubernetes  --cluster<span class="o">=</span>kubernetes  --user<span class="o">=</span>dashboard-admin --kubeconfig<span class="o">=</span>/root/dashbord-admin.conf
</pre></div>
</div>
</section>
<section id="contextdashboard-admincontext">
<h3><a class="toc-backref" href="#id23">3.5 使用的context为前面定义的名为dashboard-admin的context：</a><a class="headerlink" href="#contextdashboard-admincontext" title="Permalink to this headline">¶</a></h3>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ kubectl config use-context dashboard-admin@kubernetes  --kubeconfig<span class="o">=</span>/root/dashbord-admin.conf
</pre></div>
</div>
</section>
<section id="kubeconfig-kubeconfig">
<h3><a class="toc-backref" href="#id24">3.6 传输kubeconfig，然后使用kubeconfig登录</a><a class="headerlink" href="#kubeconfig-kubeconfig" title="Permalink to this headline">¶</a></h3>
<p>下载<code class="docutils literal notranslate"><span class="pre">/root/dashbord-admin.conf</span></code>文件用于dashboard的UI界面登录。</p>
<img alt="../../_images/image-20220421140130392.png" src="../../_images/image-20220421140130392.png" />
</section>
<section id="admin">
<h3><a class="toc-backref" href="#id25">3.7 切换到admin用户</a><a class="headerlink" href="#admin" title="Permalink to this headline">¶</a></h3>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ kubectl config use-context kubernetes-admin@kubernetes
</pre></div>
</div>
<blockquote>
<div><p>参考文献</p>
<p><a class="reference external" href="https://www.yuque.com/cuiliang-s1qrv/k8s/ag9lb6">https://www.yuque.com/cuiliang-s1qrv/k8s/ag9lb6</a></p>
<p><a class="reference external" href="https://www.yuque.com/coolops/kubernetes/kndnzu">https://www.yuque.com/coolops/kubernetes/kndnzu</a></p>
</div></blockquote>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="10.Kubernetes的扩展" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="2.%E8%B5%84%E6%BA%90%E7%9B%91%E6%8E%A7-Prometheus%E4%B8%8EGrafana.html" class="btn btn-neutral float-right" title="资源监控-Prometheus与Grafana" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019, huxiaojian.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>